<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>TapiX</title>
<style>
body {
  background: #111;
  color: #fff;
  font-family: sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  margin: 0;
  text-align: center;
  position: relative;
}
h1 { font-size: 2em; margin-bottom: 20px; }
#count { font-size: 3em; margin: 20px 0; }
#tapButton {
  background-color: #2ecc71;
  border: none;
  padding: 60px;
  font-size: 1.5em;
  border-radius: 50%;
  cursor: pointer;
  transition: transform 0.1s ease;
  width: 160px;
  height: 160px;
}
#tapButton:active { transform: scale(0.9); }

.normal-button {
  background-color: transparent;
  border: none;
  color: #fff;
  padding: 8px;
  text-align: left;
  cursor: pointer;
  font-size: 1em;
}
.normal-button:hover { background: #333; }

#message { margin-top: 20px; font-size: 1.2em; color: #f1c40f; min-height: 1.2em; }

#menu {
  position: fixed;
  top: 10px;
  left: 10px;
  font-size: 32px;
  cursor: pointer;
  user-select: none;
  transition: transform 0.2s ease;
}

.dropdown {
  position: fixed;
  top: 50px;
  left: 10px;
  background: #222;
  border: 1px solid #444;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  z-index: 1000;
  padding: 10px;
  transform: scaleY(0);
  transform-origin: top;
  transition: transform 0.15s ease, opacity 0.15s ease;
  opacity: 0;
}

.dropdown.show {
  transform: scaleY(1);
  opacity: 1;
}

/* –ú–∏–Ω–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
.modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #222;
  padding: 20px;
  border-radius: 10px;
  display: none;
  z-index: 1001;
  width: 80%;
  max-width: 400px;
}
.modal h2 { margin-top: 0; }
.close { float: right; cursor: pointer; }
.modal-buttons { display: flex; justify-content: space-between; margin-top: 20px; }
.modal-buttons button { flex: 1; margin: 0 5px; padding: 10px; font-size: 1em; cursor: pointer; border-radius: 5px; border: none; }
.btn-confirm { background-color: #e74c3c; color: white; }
.btn-cancel { background-color: #2ecc71; color: white; }

#version { position: fixed; bottom: 5px; right: 10px; font-size: 0.8em; color: #888; z-index: 500; pointer-events: none; }

/* –®–∞—Ä–∏–∫–∏ */
.ball {
  position: absolute;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ff4d4d, #cc0000);
  color: #fff;
  font-weight: bold;
  font-size: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  width: 60px;
  height: 60px;
  user-select: none;
  transition: transform 0.2s ease;
}
.particle {
  position: absolute;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #ff4d4d;
  pointer-events: none;
}
#ballScore { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); font-size: 1.5em; }
#backButton {
  position: fixed;
  top: 10px;
  left: 10px;
  padding: 8px 12px;
  background: #2ecc71;
  color: #fff;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1em;
}
</style>
</head>
<body>
<div id="menu">‚ãÆ</div>
<div class="dropdown" id="dropdown">
  <button class="normal-button" onclick="showModal('settings')">‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
  <button class="normal-button" onclick="showModal('about')">‚Ñπ –û–± –∏–≥—Ä–µ</button>
  <button class="normal-button" onclick="showModal('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
  <button class="normal-button" onclick="showModal('reset')">‚õî –°–±—Ä–æ—Å</button>
  <button class="normal-button" onclick="showModal('promo')">üéÅ –ü—Ä–æ–º–æ–∫–æ–¥</button>
  <button class="normal-button" onclick="showModal('shop')">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
  <button class="normal-button" onclick="window.open('https://t.me/TapiX_NEWS', '_blank')">üì¢ –ù–æ–≤–æ—Å—Ç–∏</button>
  <button class="normal-button" onclick="startBallsEvent()">üî¥ –ò–≤–µ–Ω—Ç "–®–∞—Ä–∏–∫–∏"</button>
</div>

<!-- –ú–∏–Ω–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
<div class="modal" id="modal-settings">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
  <button class="normal-button" onclick="toggleTheme()">üåó –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</button>
</div>

<div class="modal" id="modal-about">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–û–± –∏–≥—Ä–µ</h2>
  <p>TapiX ‚Äî —ç—Ç–æ –∏–≥—Ä–∞-–∫–ª–∏–∫–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤–∞–º –Ω—É–∂–Ω–æ —Ç–∞–ø–∞—Ç—å –ø–æ –∫–Ω–æ–ø–∫–µ, –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—á–∫–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è. –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–∞–±—Ä–∞—Ç—å 10000 –æ—á–∫–æ–≤. –£–¥–∞—á–∏!</p>
</div>

<div class="modal" id="modal-profile">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
  <div id="achievements">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π...</div>
</div>

<div class="modal" id="modal-reset">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?</h2>
  <div class="modal-buttons">
    <button class="btn-confirm" onclick="resetProgress()">–î–∞</button>
    <button class="btn-cancel" onclick="closeModals()">–ù–µ—Ç</button>
  </div>
</div>

<div class="modal" id="modal-promo">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥</h2>
  <input type="text" id="promoInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥" style="width: 100%; padding: 8px; margin-top: 10px; font-size: 1em;">
  <button class="normal-button" onclick="applyPromo()">‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
  <div id="promoMessage" style="margin-top: 10px;"></div>
</div>

<!-- –ú–∞–≥–∞–∑–∏–Ω -->
<div class="modal" id="modal-shop">
  <span class="close" onclick="closeModals()">‚úñ</span>
  <h2>–ú–∞–≥–∞–∑–∏–Ω –±—É—Å—Ç–æ–≤</h2>
  <button class="normal-button" onclick="buyBoost('x2', 1200)">x2 ‚Äî 1200 –æ—á–∫–æ–≤</button>
  <button class="normal-button" onclick="buyBoost('x5', 2500)">x5 ‚Äî 2500 –æ—á–∫–æ–≤</button>
  <button class="normal-button" onclick="buyBoost('x10', 5000)">x10 ‚Äî 5000 –æ—á–∫–æ–≤</button>
  <div id="shopMessage" style="margin-top:10px;"></div>
</div>

<h1 id="welcomeText">üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ TapiX!</h1>
<div id="count">0</div>
<button id="tapButton" onclick="tap()">–¢–∞–ø</button>
<div id="message"></div>
<div id="version">v1.2.2</div>

<div id="ballScore"></div>
<div id="backButton" style="display:none;" onclick="backToTapiX()">–ù–∞–∑–∞–¥ –≤ TapiX</div><script>
let count = parseInt(localStorage.getItem('count')) || 0;
let achievements = JSON.parse(localStorage.getItem('achievements')) || {
  "100": false,
  "500": false,
  "1000": false,
  "5000": false,
  "10000": false,
  "five_seeds": false
};
let usedCodes = JSON.parse(localStorage.getItem("usedPromoCodes")) || [];
let boosts = JSON.parse(localStorage.getItem("boosts")) || {
  "x2": false,
  "x5": false,
  "x10": false
};

let ballsActive = false;
let balls = [];
let ballsScore = 0;

document.getElementById('count').innerText = count;
updateAchievements();

// –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–∫–µ—Ä
function tap() {
  if(ballsActive) return;
  let increment = 1;
  if(boosts["x2"]) increment *= 2;
  if(boosts["x5"]) increment *= 5;
  if(boosts["x10"]) increment *= 10;

  count += increment;
  document.getElementById('count').innerText = count;
  localStorage.setItem('count', count);
  const msg = document.getElementById('message');

  if (count >= 10000 && !achievements["10000"]) { msg.innerText = "üë®‚Äçüíª –ê—Ö —Ç—ã —á–∏—Ç–µ—Ä..."; achievements["10000"]=true; }
  else if (count >= 5000 && !achievements["5000"]) { msg.innerText = "üëÄ –ö–∞–∫ —Ç—ã —ç—Ç–æ –¥–µ–ª–∞–µ—à—å?!"; achievements["5000"]=true; }
  else if (count >= 1000 && !achievements["1000"]) { msg.innerText = "üß†üî• –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã —Å–ª–æ–º–∞–ª –∏–≥—Ä—É."; achievements["1000"]=true; }
  else if (count >= 500 && !achievements["500"]) { msg.innerText = "üí™ –ê —Ç—ã —Å–µ—Ä—å—ë–∑–Ω—ã–π –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫."; achievements["500"]=true; }
  else if (count >= 100 && !achievements["100"]) { msg.innerText = "üéâ –ú–æ–ª–æ–¥–µ—Ü! –ù–æ —Ç—ã –º–æ–∂–µ—à—å –∏ –ª—É—á—à–µ."; achievements["100"]=true; }

  localStorage.setItem('achievements', JSON.stringify(achievements));
  updateAchievements();
}

function updateAchievements() {
  const list = [];
  if (achievements["100"]) list.push("üéâ –ú–æ–ª–æ–¥–µ—Ü! –ù–æ —Ç—ã –º–æ–∂–µ—à—å –∏ –ª—É—á—à–µ.");
  if (achievements["500"]) list.push("üí™ –ê —Ç—ã —Å–µ—Ä—å—ë–∑–Ω—ã–π –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫.");
  if (achievements["1000"]) list.push("üß†üî• –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã —Å–ª–æ–º–∞–ª –∏–≥—Ä—É.");
  if (achievements["5000"]) list.push("üëÄ –ö–∞–∫ —Ç—ã —ç—Ç–æ –¥–µ–ª–∞–µ—à—å?!");
  if (achievements["10000"]) list.push("üë®‚Äçüíª –ê—Ö —Ç—ã —á–∏—Ç–µ—Ä...");
  if (achievements["five_seeds"]) list.push("–•–º–º, —á—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç... –ù–∞–¥–µ—é—Å—å, —ç—Ç–æ —à—É—Ç–∫–∞.");
  document.getElementById("achievements").innerText = list.length>0? list.join("\n"):"–ù–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.";
}

function resetProgress() {
  count = 0;
  achievements = {"100":false,"500":false,"1000":false,"5000":false,"10000":false,"five_seeds":false};
  usedCodes = [];
  boosts = {"x2":false,"x5":false,"x10":false};
  localStorage.setItem('count', count);
  localStorage.setItem('achievements', JSON.stringify(achievements));
  localStorage.setItem("usedPromoCodes", JSON.stringify(usedCodes));
  localStorage.setItem("boosts", JSON.stringify(boosts));
  document.getElementById('count').innerText = count;
  document.getElementById('message').innerText = '';
  updateAchievements();
  closeModals();
}

function showModal(id) { closeModals(); document.getElementById('dropdown').classList.remove('show'); document.getElementById(`modal-${id}`).style.display='block'; }
function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display='none'); }

const menuBtn = document.getElementById('menu');
const dropdown = document.getElementById('dropdown');

menuBtn.addEventListener('click', ()=>{
  dropdown.classList.toggle('show');
});

// –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –º–µ–Ω—é
menuBtn.addEventListener('mouseenter', ()=>{ dropdown.style.transition='transform 0.15s ease, opacity 0.15s ease'; });
menuBtn.addEventListener('mouseleave', ()=>{ dropdown.style.transition='transform 0.15s ease, opacity 0.15s ease'; });

function toggleTheme(){
  const dark = document.body.style.background==="rgb(255, 255, 255)";
  document.body.style.background=dark?"#111":"#fff";
  document.body.style.color=dark?"#fff":"#111";
}

const promoCodes = {"SUNNYDAY":500,"BITEBYTE":300,"LUCKYCLAP":700,"PIXELRUSH":250,"COZYTAP":400,"TAPWAVE":600,"ZAPBOOM":1000,"QUIETPOWER":350,"TAPSTORM":450,"CLOUDYCODE":150,"NEONTAP":200,"BUBBLETAP":550,"GAMERGRIND":800,"EASYTAP":100,"FINALHIT":900,"221B":221};

function applyPromo(){
  const input = document.getElementById("promoInput").value.trim().toUpperCase();
  const msg = document.getElementById("promoMessage");
  if(usedCodes.includes(input)){ msg.innerText="‚ùó –≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω."; return; }
  if(input==="FIVEOSEEDS"){
    msg.innerText="–í–∞–º –ø—Ä–∏—à–ª–æ –ø–∏—Å—å–º–æ! –í–Ω—É—Ç—Ä–∏ –ø–∏—Å—å–º–∞ 5 –∞–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã—Ö –∑—ë—Ä–Ω—ã—à–µ–∫ –∏ –Ω–∞–¥–ø–∏—Å—å KKK";
    count=5;
    achievements["five_seeds"]=true;
    if(!usedCodes.includes(input)) usedCodes.push(input);
    localStorage.setItem('count', count);
    localStorage.setItem('achievements', JSON.stringify(achievements));
    localStorage.setItem("usedPromoCodes", JSON.stringify(usedCodes));
    updateAchievements();
    document.getElementById('count').innerText=count;
    return;
  }
  if(promoCodes[input]){
    count+=promoCodes[input];
    msg.innerText=`üéâ +${promoCodes[input]} –æ—á–∫–æ–≤!`;
    usedCodes.push(input);
    localStorage.setItem('count', count);
    localStorage.setItem("usedPromoCodes", JSON.stringify(usedCodes));
    document.getElementById('count').innerText=count;
  } else { msg.innerText="‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥."; }
}

function buyBoost(type,price){
  const msg = document.getElementById("shopMessage");
  if(count<price){ msg.innerText="‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏."; return; }
  if(boosts[type]){ msg.innerText="‚ùó –ë—É—Å—Ç —É–∂–µ –∫—É–ø–ª–µ–Ω."; return; }
  count-=price; boosts[type]=true;
  localStorage.setItem('count', count);
  localStorage.setItem("boosts", JSON.stringify(boosts));
  document.getElementById('count').innerText=count;
  msg.innerText=`üéâ –í—ã –∫—É–ø–∏–ª–∏ –±—É—Å—Ç ${type}!`;
}

// --- –ò–í–ï–ù–¢ –®–ê–†–ò–ö–ò ---
function startBallsEvent(){
  ballsActive=true;
  document.getElementById('welcomeText').style.display='none';
  document.getElementById('tapButton').style.display='none';
  document.getElementById('count').style.display='none';
  document.getElementById('message').style.display='none';
  document.getElementById('dropdown').style.display='none';
  document.getElementById('backButton').style.display='block';
  document.getElementById('ballScore').innerText='–û—á–∫–∏: 0';
  ballsScore=0;
  spawnBalls(5);
}

function spawnBalls(number){
  balls.forEach(b=>b.remove());
  balls=[];
  for(let i=0;i<number;i++){
    createBall();
  }
}

function createBall(){
  const ball=document.createElement('div');
  ball.className='ball';
  const value=Math.floor(Math.random()*201)+30;
  ball.innerText=value;
  positionBall(ball);
  document.body.appendChild(ball);
  balls.push(ball);
  ball.addEventListener('click',()=>{
    ballsScore+=value;
    document.getElementById('ballScore').innerText='–û—á–∫–∏: '+ballsScore;
    explodeBall(ball);
    setTimeout(createBall,50);
  });
}

function positionBall(ball){
  const x=Math.random()*(window.innerWidth-70);
  const y=Math.random()*(window.innerHeight-150)+50;
  ball.style.left=x+'px';
  ball.style.top=y+'px';
}

function explodeBall(ball){
  for(let i=0;i<8;i++){
    const p=document.createElement('div');
    p.className='particle';
    p.style.left=parseInt(ball.style.left)+30+'px';
    p.style.top=parseInt(ball.style.top)+30+'px';
    document.body.appendChild(p);
    const angle=Math.random()*2*Math.PI;
    const dist=30+Math.random()*20;
    p.style.transform=`translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px)`;
    setTimeout(()=>p.remove(),300);
  }
  ball.remove();
  balls=balls.filter(b=>b!==ball);
}

// –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
function backToTapiX(){
  ballsActive=false;
  document.getElementById('welcomeText').style.display='block';
  document.getElementById('tapButton').style.display='block';
  document.getElementById('count').style.display='block';
  document.getElementById('message').style.display='block';
  document.getElementById('dropdown').style.display='flex';
  document.getElementById('backButton').style.display='none';
  document.getElementById('ballScore').innerText='';
  // –ó–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—á–µ—Ç
  count+=ballsScore;
  localStorage.setItem('count', count);
  document.getElementById('count').innerText=count;
  updateAchievements();
  balls.forEach(b=>b.remove());
  balls=[];
}
</script>
</body>
  </html>
